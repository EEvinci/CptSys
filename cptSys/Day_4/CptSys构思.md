# 竞赛系统概念模型：

**具体要求如下：**

![image-20220828094757016](http://evinci.oss-cn-hangzhou.aliyuncs.com/evinci/image-20220828094757016.png)

![image-20220828094812972](http://evinci.oss-cn-hangzhou.aliyuncs.com/evinci/image-20220828094812972.png)

现设计出的不完善的概念模型为：

![image-20220828094840261](http://evinci.oss-cn-hangzhou.aliyuncs.com/evinci/image-20220828094840261.png)

现主要问题是表间关系的设计，由设计要求理解的表之间的关系对应准则如下：

准则1：竞赛报名以队伍为单位，即使单人参赛，也需要先组队

准则2：在一项竞赛中，一名学生只能作为一支队伍的成员，不能重复报名

准则3：先组队，后参赛

准则4：赛项信息，竞赛信息均由管理员维护



- - **先组队,后参赛**, 即一个学生必须先成为一个队的队员, 然后才能提交比赛报名表, **即`队员信息表`相较`报名`逻辑靠前**

- **学生可以组队成为队员，且不能重复报名,** 即一个学生只能参加一个队伍, 即一个学生只能提交一个组队申请, 即一个学生只能有一个队员信息表, 即`学生信息表`和`队员信息表`之间的是`一对一`的`组队`关系 (更正如下)

> **在一项竞赛中**, 学生只能作为一个队伍的队员, 但是**学生可以参加不同类别的竞赛从而成为多个队伍的队员**, 所以一个`学生信息表`可以对应多个`队员信息表`, 一个`队员信息表`只能对应一个`学生信息表`, 所以`学生信息表`和`队员信息表`应该是`一对多`的`组队`关系

- `组队表`内是一个队伍的信息, 同时因为`队员信息表`中含有`队伍编号`属性, 即一个`队员信息表`唯一对应一个`组队表`, 所以`队员信息表`和`组队表`之间的关系为`一对一`
- - 考虑到学生可以参加不同种的竞赛, 即可以提交多个队员信息表, 一个队同时参加多种竞赛的可能性较小, 同时需求中没有提及队伍和竞赛数量之间的对应关系, **所以此处默认一个队伍只参加一个竞赛**, 即`组队表`和`报名`之间的关系为`一对一`, `报名`和`竞赛信息`之间的关系为`一对一`
- - 一个赛项包含多种竞赛, 一个竞赛属于一种赛项, 即`赛项信息`和`竞赛信息`之间的关系为`一对多`
- 一个管理员可以管理多个竞赛或者赛项的信息, 一个竞赛或者赛项的信息可能被多个管理员进行管理, 所以`管理员信息表`和`赛项信息` `竞赛信息`之间的关系均为`多对多`



上述条目前标了两个点的是正确的:

- 对于`学生信息表`和`队伍表`之间的关系:

  -  首先应将`组队`看作是一个`关系`, 而非是一个`实体`, `关系`连接两个实体, 在连接时不应包含连接的`实体`中的属性

  - 在之前我将`队伍表`和`学生信息表`理解成了是`一对一`的关系, 因为我以为一个队伍和一个学生唯一绑定, 但忽略了对于一个队伍中的所有学生来说, 队伍信息都是相同的, 即一个队伍对应多个学生; 与此同时, 一个学生还可以参加不同的队伍, 对于一个学生来说, 可能有着不止一个的队伍信息, 所以`队伍表`和`学生信息表`之间的关系应该是`多对多`.

- 对于管理员管理竞赛或者赛项的关系倒是不必太过在意, 因为没有太过于直接的关联.



完善后的 **CompetitionSystem概念模型**

![Competition概念模型](http://evinci.oss-cn-hangzhou.aliyuncs.com/evinci/image-20220828114605803.png)

完善后的 **CompetitionSystem物理模型**

![image-20220828115654972](http://evinci.oss-cn-hangzhou.aliyuncs.com/evinci/image-20220828115654972.png)



**系统设计：**

`cn.zucc.edu.dao` **data access object 数据访问对象**

`cn.zucc.edu.util` **工具包**

`cn.zucc.edu.view` **界面设计**

`cn.zucc.edu.models` **实体**

`cn.zucc.edu.cn.images` **界面设计图标** 



**设计过程：**

1. 先创建`models`包, 有几个表，`models`包中就有几个类

2. 然后完善`view`包进行界面设计

3. 最后`dao`包，将业务代码完善



# `view`包`登录界面`设计

## 登录验证

**问题/1\:**

在设计登录时`用户名密码匹配验证`时, 需要考虑用户有两类, 一类是学生, 一类是管理员,

所以这时不能简单地只将学生的数据库与登录功能进行连接, 管理员的数据库也要进行连接, 即管理员也要创建对象, 然后获取用户名密码信息, 再进行判断

这样会造成代码**较为冗杂**



**解决思路:**

管理员和学生同为用户, 所以可以创建一个用户表, 将学生和管理员的登录信息合并到一起, 从而简化登录时用户名密码判断的复杂程度                                                                                                                    

但是这样在后期的学生信息查询中可能又会造成一定的麻烦



​                                                                                                      

**问题/2\:** 

那在新创建的`User`表中, 是否要创建一个属性用来区分管理员和学生呢



**解决思路:** 

应该是要的, 否则无法区分权限

那如果是这样的话还不如不创建一个新表, 虽然在登录验证的时候代码繁琐了一点, 但是后期在身份区分所导致的权限问题上就简单了许多

这张`UserLog`表可以先保留, 但是登录验证的时候还是对管理员和用户分别验证登录

这时对于学生来说: 用户名就默认为`学号`

对于管理员来说: 用户名就默认为管理员ID



**最终思路:** 

如果不合成一个表, 在登录判断时要分别判断, 并且之后在进行登录身份查询的时候也要写两个`Dao`文件, 好处是管理员和学生分的比较开, 在后期权限问题或者查询问题上可能少些麻烦

如果合成一个表, 那么在登录判断和登陆身份查询时都可以简单一些, 在此基础上, 可以添加第三个`身份`属性用来区分管理员和学生, 用来解决权限问题

**所以最终采用多添加一个属性的合成一个`UserLog`表的方式**





## 页面布局

现在预想的几个问题：

1. 既然采用了`统一管理登录`的方式, 那么管理员的权限问题应该如何设置

   - **目前的想法是**: 

   在系统中增加一个`管理员模式`

   进入`管理员模式`需要输入管理员ID和密码, 在系统中增加一个`二次登陆`的方式, 从而区分开学生和管理员

   **管理员的权限**如下:

   ![image-20220829142307144](http://evinci.oss-cn-hangzhou.aliyuncs.com/evinci/image-20220829142307144.png)

   **预想页面:**

   - 在主页面上有一个`管理员模式`

   - 点击`管理员模式`, 会跳出来一个`管理员登录界面`

   - 在输入管理员ID和密码后, 会进入一个`竞赛信息管维护统计主界面`

     > 这样设计其实有点怪, 在第一次登陆的时候管理员已经输入自己的admin帐号了, 进入之后却还要再输入一次, 在使用逻辑上不合理
     >
     > **但是如果要在第一次输入的时候就进行管理员和学生的识别, 那么就要设置两个不同的主页面**
     >
     > **可以在登录页面增加一个Button叫`管理员登录`, 然后再输入admin的账户密码进入管理页面**
     >
     > **登陆页面的登录面向学生, 即正常登陆就是以学生身份登录, 然后进入学生的竞赛报名页面**

   - 主页面上方依次有`赛项管理` `竞赛管理` `队伍管理` `查询统计`
   - `赛项管理`链接到`cptitemsinfo`表, 将数据库中的信息展示出来
   - `竞赛管理`链接到`cptinfo`表, 将数据库中的信息展示出来
   - `队伍管理`链接到`team`表, 将数据库中的信息展示出来, 在这里管理员可以`设置队伍的获奖等级`
   - 对这三个表的管理, 用`删除记录/修改记录/添加记录`的方式
   - `查询统计`里面有`查询学生获奖情况` %47  